import numpy as np
import matplotlib
import matplotlib.pyplot as plt
from matplotlib.pyplot import gca
import matplotlib.font_manager
import sys
from skspatial.objects import Line, Point
from skspatial.plotting import plot_2d

# python3 plots/tese/example_cyclic_coherent.py

x_init = [10, 8]

x_init_point = Point(x_init)

l1 = Line.from_points([0,0], [12,12])
l2 = Line.from_points([4,0], [8,12])
l3 = Line.from_points([6,0], [6,12])
l4 = Line.from_points([8,0], [4,12])
l5 = Line.from_points([0,12], [12,0])
l6 = Line.from_points([0,8], [12,4])
l7 = Line.from_points([0,6], [12,6])
l8 = Line.from_points([0,4], [12,8])

x1_point = l1.project_point(x_init_point)
x1 = np.array(x1_point)
x2_point = l2.project_point(x1_point)
x2 = np.array(x2_point)
x3_point = l3.project_point(x2_point)
x3 = np.array(x3_point)
x4_point = l4.project_point(x3_point)
x4 = np.array(x4_point)
x5_point = l5.project_point(x4_point)
x5 = np.array(x5_point)
x6_point = l6.project_point(x5_point)
x6 = np.array(x6_point)
x7_point = l7.project_point(x6_point)
x7 = np.array(x7_point)
x8_point = l8.project_point(x7_point)
x8 = np.array(x8_point)
x9_point = l1.project_point(x8_point)
x9 = np.array(x9_point)
x9_point = l2.project_point(x9_point)
x10 = np.array(x9_point)
x10_point = l3.project_point(x9_point)
x11 = np.array(x10_point)
x11_point = l4.project_point(x10_point)
x12 = np.array(x11_point)
x12_point = l5.project_point(x11_point)
x13 = np.array(x12_point)
x13_point = l6.project_point(x12_point)
x14 = np.array(x13_point)
x14_point = l7.project_point(x13_point)
x15 = np.array(x14_point)
x15_point = l8.project_point(x14_point)
x16 = np.array(x15_point)
x16_point = l1.project_point(x15_point)
x17 = np.array(x16_point)
x17_point = l2.project_point(x16_point)
x18 = np.array(x17_point)
x18_point = l3.project_point(x17_point)
x19 = np.array(x18_point)
x19_point = l4.project_point(x18_point)
x20 = np.array(x19_point)
x21_point = l5.project_point(x19_point)
x21 = np.array(x21_point)
x22_point = l6.project_point(x21_point)
x22 = np.array(x22_point)
x23_point = l7.project_point(x22_point)
x23 = np.array(x23_point)
x24_point = l8.project_point(x23_point)
x24 = np.array(x24_point)
x25_point = l1.project_point(x24_point)
x25 = np.array(x25_point)
x26_point = l2.project_point(x25_point)
x26 = np.array(x26_point)
x27_point = l3.project_point(x26_point)
x27 = np.array(x27_point)
x28_point = l4.project_point(x27_point)
x28 = np.array(x28_point)
x29_point = l5.project_point(x28_point)
x29 = np.array(x29_point)
x30_point = l6.project_point(x29_point)
x30 = np.array(x30_point)
x31_point = l7.project_point(x30_point)
x31 = np.array(x31_point)
x32_point = l8.project_point(x31_point)
x32 = np.array(x32_point)
x33_point = l1.project_point(x32_point)
x33 = np.array(x33_point)
x34_point = l2.project_point(x33_point)
x34 = np.array(x34_point)
x35_point = l3.project_point(x34_point)
x35 = np.array(x35_point)
x36_point = l4.project_point(x35_point)
x36 = np.array(x36_point)
x37_point = l5.project_point(x36_point)
x37 = np.array(x37_point)
x38_point = l6.project_point(x37_point)
x38 = np.array(x38_point)
x39_point = l7.project_point(x38_point)
x39 = np.array(x39_point)
x40_point = l8.project_point(x39_point)
x40 = np.array(x40_point)
x41_point = l1.project_point(x40_point)
x41 = np.array(x41_point)
x42_point = l2.project_point(x41_point)
x42 = np.array(x42_point)
x43_point = l3.project_point(x42_point)
x43 = np.array(x43_point)
x44_point = l4.project_point(x43_point)
x44 = np.array(x44_point)
x45_point = l5.project_point(x44_point)
x45 = np.array(x45_point)
x46_point = l6.project_point(x45_point)
x46 = np.array(x46_point)
x47_point = l7.project_point(x46_point)
x47 = np.array(x47_point)
x48_point = l8.project_point(x47_point)
x48 = np.array(x48_point)
x49_point = l1.project_point(x48_point)
x49 = np.array(x49_point)
x50_point = l2.project_point(x49_point)
x50 = np.array(x50_point)
x51_point = l3.project_point(x50_point)
x51 = np.array(x51_point)
x52_point = l4.project_point(x51_point)
x52 = np.array(x52_point)
x53_point = l5.project_point(x52_point)
x53 = np.array(x53_point)
x54_point = l6.project_point(x53_point)
x54 = np.array(x54_point)

plt.rc('text', usetex=True)
plt.rc('font', family='serif')

l1 = Line.from_points([0,0], [12,12])
l2 = Line.from_points([4,0], [8,12])
l3 = Line.from_points([6,0], [6,12])
l4 = Line.from_points([8,0], [4,12])
l5 = Line.from_points([0,12], [12,0])
l6 = Line.from_points([0,8], [12,4])
l7 = Line.from_points([0,6], [12,6])
l8 = Line.from_points([0,4], [12,8])

fig = plt.figure(figsize=(6, 6))
plt.plot([0,12], [0,12], color='green', label=r'$\langle a_1,x \rangle = b_1$')
plt.plot([4,8], [0,12], color='yellow', label=r'$\langle a_2,x \rangle = b_2$')
plt.plot([6,6], [0,12], color='orange', label=r'$\langle a_3,x \rangle = b_3$')
plt.plot([8,4], [0,12], color='red', label=r'$\langle a_4,x \rangle = b_4$')
plt.plot([0,12], [12,0], color='brown', label=r'$\langle a_5,x \rangle = b_5$')
plt.plot([0,12], [8,4], color='purple', label=r'$\langle a_6,x \rangle = b_6$')
plt.plot([0,12], [6,6], color='magenta', label=r'$\langle a_7,x \rangle = b_7$')
plt.plot([0,12], [4,8], color='blue', label=r'$\langle a_8,x \rangle = b_8$')
plt.plot([x_init[0], x1[0]], [x_init[1], x1[1]], color='grey', linestyle='--')
plt.plot([x1[0], x2[0]], [x1[1], x2[1]], color='grey', linestyle='--')
plt.plot([x2[0], x3[0]], [x2[1], x3[1]], color='grey', linestyle='--')
plt.plot([x3[0], x4[0]], [x3[1], x4[1]], color='grey', linestyle='--')
plt.plot([x4[0], x5[0]], [x4[1], x5[1]], color='grey', linestyle='--')
plt.plot([x5[0], x6[0]], [x5[1], x6[1]], color='grey', linestyle='--')
plt.plot([x6[0], x7[0]], [x6[1], x7[1]], color='grey', linestyle='--')
plt.plot([x7[0], x8[0]], [x7[1], x8[1]], color='grey', linestyle='--')
plt.plot([x8[0], x9[0]], [x8[1], x9[1]], color='grey', linestyle='--')
plt.plot([x9[0], x10[0]], [x9[1], x10[1]], color='grey', linestyle='--')
plt.plot([x10[0], x11[0]], [x10[1], x11[1]], color='grey', linestyle='--')
plt.plot([x11[0], x12[0]], [x11[1], x12[1]], color='grey', linestyle='--')
plt.plot([x12[0], x13[0]], [x12[1], x13[1]], color='grey', linestyle='--')
plt.plot([x13[0], x14[0]], [x13[1], x14[1]], color='grey', linestyle='--')
plt.plot([x14[0], x15[0]], [x14[1], x15[1]], color='grey', linestyle='--')
plt.plot([x15[0], x16[0]], [x15[1], x16[1]], color='grey', linestyle='--')
plt.plot([x16[0], x17[0]], [x16[1], x17[1]], color='grey', linestyle='--')
plt.plot([x17[0], x18[0]], [x17[1], x18[1]], color='grey', linestyle='--')
plt.plot([x18[0], x19[0]], [x18[1], x19[1]], color='grey', linestyle='--')
plt.plot([x19[0], x20[0]], [x19[1], x20[1]], color='grey', linestyle='--')
plt.plot([x20[0], x21[0]], [x20[1], x21[1]], color='grey', linestyle='--')
plt.plot([x21[0], x22[0]], [x21[1], x22[1]], color='grey', linestyle='--')
plt.plot([x23[0], x24[0]], [x23[1], x24[1]], color='grey', linestyle='--')
plt.plot([x24[0], x25[0]], [x24[1], x25[1]], color='grey', linestyle='--')
plt.plot([x25[0], x26[0]], [x25[1], x26[1]], color='grey', linestyle='--')
plt.plot([x26[0], x27[0]], [x26[1], x27[1]], color='grey', linestyle='--')
plt.plot([x27[0], x28[0]], [x27[1], x28[1]], color='grey', linestyle='--')
plt.plot([x28[0], x29[0]], [x28[1], x29[1]], color='grey', linestyle='--')
plt.plot([x29[0], x30[0]], [x29[1], x30[1]], color='grey', linestyle='--')
plt.plot([x30[0], x31[0]], [x30[1], x31[1]], color='grey', linestyle='--')
plt.plot([x31[0], x32[0]], [x31[1], x32[1]], color='grey', linestyle='--')
plt.plot([x32[0], x33[0]], [x32[1], x33[1]], color='grey', linestyle='--')
plt.plot([x33[0], x34[0]], [x33[1], x34[1]], color='grey', linestyle='--')
plt.plot([x34[0], x35[0]], [x34[1], x35[1]], color='grey', linestyle='--')
plt.plot([x35[0], x36[0]], [x32[1], x36[1]], color='grey', linestyle='--')
plt.plot([x36[0], x37[0]], [x36[1], x37[1]], color='grey', linestyle='--')
plt.plot([x37[0], x38[0]], [x37[1], x38[1]], color='grey', linestyle='--')
plt.plot([x38[0], x39[0]], [x38[1], x39[1]], color='grey', linestyle='--')
plt.plot([x39[0], x40[0]], [x39[1], x40[1]], color='grey', linestyle='--')
plt.plot([x40[0], x41[0]], [x40[1], x41[1]], color='grey', linestyle='--')
plt.plot([x41[0], x42[0]], [x41[1], x42[1]], color='grey', linestyle='--')
plt.plot([x42[0], x43[0]], [x42[1], x43[1]], color='grey', linestyle='--')
plt.plot([x43[0], x44[0]], [x43[1], x44[1]], color='grey', linestyle='--')
plt.plot([x44[0], x45[0]], [x44[1], x45[1]], color='grey', linestyle='--')
plt.plot([x45[0], x46[0]], [x42[1], x46[1]], color='grey', linestyle='--')
plt.plot([x46[0], x47[0]], [x46[1], x47[1]], color='grey', linestyle='--')
plt.plot([x47[0], x48[0]], [x47[1], x48[1]], color='grey', linestyle='--')
plt.scatter(x_init[0], x_init[1], color='c', label=r'$x^{(0)}$')
plt.scatter(x1[0], x1[1], color='black', label=r'$x^{(k)}$', zorder=2)
plt.scatter(x2[0], x2[1], color='black', zorder=2)
plt.scatter(x3[0], x3[1], color='black', zorder=2)
plt.scatter(x4[0], x4[1], color='black', zorder=2)
plt.scatter(x5[0], x5[1], color='black', zorder=2)
plt.scatter(x6[0], x6[1], color='black', zorder=2)
plt.scatter(x7[0], x7[1], color='black', zorder=2)
plt.scatter(x8[0], x8[1], color='black', zorder=2)
plt.scatter(x9[0], x9[1], color='black', zorder=2)
plt.scatter(x10[0], x10[1], color='black', zorder=2)
plt.scatter(x11[0], x11[1], color='black', zorder=2)
plt.scatter(x12[0], x12[1], color='black', zorder=2)
plt.scatter(x13[0], x13[1], color='black', zorder=2)
plt.scatter(x14[0], x14[1], color='black', zorder=2)
plt.scatter(x15[0], x15[1], color='black', zorder=2)
plt.scatter(x16[0], x16[1], color='black', zorder=2)
plt.scatter(x17[0], x17[1], color='black', zorder=2)
plt.scatter(x18[0], x18[1], color='black', zorder=2)
plt.scatter(x19[0], x19[1], color='black', zorder=2)
plt.scatter(x20[0], x20[1], color='black', zorder=2)
plt.scatter(x21[0], x21[1], color='black', zorder=2)
plt.scatter(x22[0], x22[1], color='black', zorder=2)
plt.scatter(x23[0], x23[1], color='black', zorder=2)
plt.scatter(x24[0], x24[1], color='black', zorder=2)
plt.scatter(x25[0], x25[1], color='black', zorder=2)
plt.scatter(x26[0], x26[1], color='black', zorder=2)
plt.scatter(x27[0], x27[1], color='black', zorder=2)
plt.scatter(x28[0], x28[1], color='black', zorder=2)
plt.scatter(x29[0], x29[1], color='black', zorder=2)
plt.scatter(x30[0], x30[1], color='black', zorder=2)
plt.scatter(x31[0], x31[1], color='black', zorder=2)
plt.scatter(x32[0], x32[1], color='black', zorder=2)
plt.scatter(x33[0], x33[1], color='black', zorder=2)
plt.scatter(x34[0], x34[1], color='black', zorder=2)
plt.scatter(x35[0], x35[1], color='black', zorder=2)
plt.scatter(x36[0], x36[1], color='black', zorder=2)
plt.scatter(x37[0], x37[1], color='black', zorder=2)
plt.scatter(x38[0], x38[1], color='black', zorder=2)
plt.scatter(x29[0], x39[1], color='black', zorder=2)
plt.scatter(x30[0], x40[1], color='black', zorder=2)
plt.scatter(x41[0], x41[1], color='black', zorder=2)
plt.scatter(x42[0], x42[1], color='black', zorder=2)
plt.scatter(x43[0], x43[1], color='black', zorder=2)
plt.scatter(x44[0], x44[1], color='black', zorder=2)
plt.scatter(x45[0], x45[1], color='black', zorder=2)
plt.scatter(x46[0], x46[1], color='black', zorder=2)
plt.scatter(x47[0], x47[1], color='black', zorder=2)
plt.scatter(x48[0], x48[1], color='black', zorder=2)
plt.scatter(x49[0], x49[1], color='black', zorder=2)
plt.scatter(x50[0], x50[1], color='black', zorder=2)
plt.scatter(x51[0], x51[1], color='black', zorder=2)
plt.scatter(x52[0], x52[1], color='black', zorder=2)
plt.scatter(x53[0], x53[1], color='black', zorder=2)
plt.scatter(x54[0], x54[1], color='black', zorder=2)
plt.grid()
plt.axis('equal')
plt.xlim([0, 12])
plt.ylim([0, 12])
plt.legend(loc='best')
plt.ylabel(r'$y$')
plt.xlabel(r'$x$')

filename_fig = "example_cyclic_coherent"

plt.show()
fig.savefig("plots/tese/pdf/"+filename_fig+".pdf", bbox_inches='tight')
fig.savefig("plots/tese/png/"+filename_fig+".png", bbox_inches='tight')
